<!DOCTYPE html>
<html lang="en">
<head>
    <title>WebSocket client</title>
</head>

<body>
<form action="#" method="post" id="send-message-form">
    <label>
        Send message:<br/>
        <input type="text" name="message"/>
    </label>
</form>
<div id="messageArea">
    <p>Waiting for messages...</p>
    <ul id="messages">
    </ul>
</div>
</body>

<script>
    const ws = new WebSocket('ws://localhost:3030/ws');
    const sendMessageForm = document.getElementById("send-message-form");
    const messageList = document.getElementById("messages");

    const addMessage = (sender, msg) => {
        const elem = document.createElement("li");
        elem.innerText = `${sender}: ${msg}`;
        messageList.appendChild(elem);
    }

    const onSubmit = (event) => {
        event.preventDefault();
        event.stopPropagation();

        const form = event.target;
        addMessage('Me', form.message.value);

        form.reset();
    }

    sendMessageForm.onsubmit = onSubmit;

    ws.onopen = function () {
        console.log('WebSocket Client Connected');
        ws.send('Hi this is web client.');
    };

    ws.onmessage = function (e) {
        addMessage('Server', e.data);
    };
</script>
</html>